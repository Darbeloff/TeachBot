{"sections": [
	{
		"id": "intro",
		"instructions": [
			{
				"type":"clearRect"
			},
			{
				"type":"drawBox",
				"number":1
			},
			{
				"type":"drawBox",
				"number":2
			},
			{
				"type":"drawBox",
				"number":3
			},
			{
				"type":"drawBox",
				"number":4
			},
			{
				"type":"drawBin",
				"number":1
			},
			{
				"//":"0: Today, we will be learning about the gripper. Many of today's activities will involve the boxes and bins on the table.",
				"type":"play",
				"audio_index":0,
				"delay":true
			},
			{
				"//":"1: So, let's get started. I'm going to grab Box 1 with my hands.",
				"type":"play",
				"audio_index":1,
				"delay":true
			},
			{
				"type":"goToJointAngles",
				"joint_angles":"init_joint_arg"
			},
			{
				"type":"goToJointAngles",
				"joint_angles":"fail_init_joint_arg"
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT"
			},
			{
				"type":"closeGripper"
			},
			{
				"//":"3: Oh, that's embarrassing. Let me try again. I think I know what I did wrong. Would you please move the box back into the designated area? Press the scroll wheel on my arm when you've done so.",
				"type":"play",
				"audio_index":2,
				"delay":false
			},
			{
				"type":"goToCartesianPose",
				"position":"None",
				"orientation":"None",
				"relative_pose":"None",
				"joint_angles":"fail_init_joint_arg",
				"endpoint_pose":"None"
			},
			{
				"type":"openGripper"
			},
			{
				"type":"pressed_button"
			},
			{
				"type":"proceed",
				"to_section":"1Dof"
			}
		]
	},
	{
		"id": "1Dof",
		"instructions":[
			{
				"//":"0: The first important concept to learn is the one I just messed up: orientation. As you saw, my hand can't grab the object like this. But...",
				"type":"play",
				"audio_index":0,
				"delay":true
			},
			{
				"//":"1: ...if I change the orientation of my hand, I can pick up this object.",
				"type":"play",
				"audio_index":1,
				"delay":false
			},
			{
				"type":"goToJointAngles",
				"joint_angles":"success_pickup_box1"
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT"
			},
			{
				"type":"closeGripper"
			},
			{
				"type":"goToCartesianPose",
				"position":"None",
				"orientation":"None",
				"relative_pose":"None",
				"joint_angles":"success_pickup_box1",
				"endpoint_pose":"None"
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT"
			},
			{
				"type":"openGripper"
			},
			{
				"type":"goToCartesianPose",
				"position":"None",
				"orientation":"None",
				"relative_pose":"None",
				"joint_angles":"success_pickup_box1",
				"endpoint_pose":"None"
			},
			{
				"type":"goToCartesianPose",
				"position":"None",
				"orientation":"None",
				"relative_pose":"None",
				"joint_angles":"above_second_box_joint_arg",
				"endpoint_pose":"None"
			},
			{
				"//":"2: Now you try. I have moved my hand over Box 2. Can you rotate my wrist so I can pick up Box 2? When you're ready for me to pick up the box, press the scroll wheel button.",
				"type":"play",
				"audio_index":2,
				"delay":false
			},
			{
				"type":"set",
				"key":"p",
				"val":false
			},
			{
				"type":"while",
				"conditional":"#p===false",
				"instructions":[
					{
						"type":"interaction_control",
						"position_only":false,
						"orientation_x":false,
						"orientation_y":false,
						"orientation_z":true,
						"position_x":false,
						"position_y":false,
						"position_z":false,
						"in_end_point_frame":true,
						"PASS":true,
						"ways":false,
						"wait":true
					},
					{
						"//":"3: Alright. Let’s see.",
						"type":"play",
						"audio_index":3,
						"delay":true
					},
					{
						"type":"check_pickup",
						"store_answer_in":"wheelVal"
					},
					{
						"type":"if",
						"conditional":"#wheelVal==1",
						"if_true":[
							{
								"type":"set",
								"key":"p",
								"val":true
							}
						],
						"if_false":[
							{
								"//":"5: Oops, I couldn’t pick it up like that. This time, try to get the entire width of the box in my grasp.",
								"type":"play",
								"audio_index":5,
								"delay":false
							}
						]
					}
				]
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT/2"
			},
			{
				"type":"openGripper"
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT+0.1"
			},
			{
				"//":"4: Great! I was abe to determine if I succesfully picked up the box by comparing the force my motors exert on my joints to maintain my position before and after closing the gripper.",
				"type":"play",
				"audio_index":4,
				"delay":true
			},
			{
				"//":"6: You just helped me change my gripper's orientation so that I could pick up the box. Now, help me pick up Box 3. This time, my gripper is already in the correct orientation, but not in the correct position. Can you move my hand so that it can pick up Box 3? When you're ready for me to pick up the box, press the scroll wheel button.",
				"type":"play",
				"audio_index":6,
				"delay":false
			},
			{
				"type":"set",
				"key":"p",
				"val":false
			},
			{
				"type":"while",
				"conditional":"#p===false",
				"instructions":[
					{
						"type":"interaction_control",
						"position_only":false,
						"orientation_x":false,
						"orientation_y":false,
						"orientation_z":false,
						"position_x":true,
						"position_y":false,
						"position_z":false,
						"in_end_point_frame":false,
						"PASS":true,
						"ways":false,
						"wait":true
					},
					{
						"//":"3: Alright. Let’s see.",
						"type":"play",
						"audio_index":3,
						"delay":true
					},
					{
						"type":"check_pickup",
						"store_answer_in":"wheelVal"
					},
					{
						"type":"if",
						"conditional":"#wheelVal==1",
						"if_true":[
							{
								"type":"set",
								"key":"p",
								"val":true
							}
						],
						"if_false":[
							{
								"//":"5: Oops, I couldn’t pick it up like that. This time, try to get the entire width of the box in my grasp.",
								"type":"play",
								"audio_index":5,
								"delay":false
							}
						]
					}
				]
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT/2"
			},
			{
				"type":"openGripper"
			},
			{
				"type":"goToCartesianPose",
				"position":"None",
				"orientation":"None",
				"relative_pose":"None",
				"joint_angles":"above_third_box_joint_arg",
				"endpoint_pose":"None"
			},
			{
				"//":"7:Great! Before, you helped me change my gripper's orientation so that I could pick up Box 2. This time, you helped me change my gripper's position so that I could pick up Box 3.",
				"type":"play",
				"audio_index":7,
				"delay":true
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT+0.04"
			},
			{
				"type":"pos_orient"
			},
			{
				"//":"8: Now, help me pick up Box 4. If you press the gray button on my wrist, you can change my arm's position. If you press the white button on my wrist, you can change my arm's orientation. Feel free to switch between the two modes to figure out the difference between the position and orientation. When you're ready for me to pick up Box 4, press the scroll wheel button.",
				"type":"play",
				"audio_index":8,
				"delay":false
			},
			{
				"type":"set",
				"key":"p",
				"val":false
			},
			{
				"type":"while",
				"conditional":"#p===false",
				"instructions":[
					{
						"type":"cuff_interaction",
						"terminatingCondition":"lambda self: self.finished",
						"ways":false
					},
					{
						"//":"3: Alright. Let’s see.",
						"type":"play",
						"audio_index":3,
						"delay":true
					},
					{
						"type":"check_pickup",
						"store_answer_in":"wheelVal"
					},
					{
						"type":"if",
						"conditional":"#wheelVal==1",
						"if_true":[
							{
								"type":"set",
								"key":"p",
								"val":true
							}
						],
						"if_false":[
							{
								"//":"5: Oops, I couldn’t pick it up like that. This time, try to get the entire width of the box in my grasp.",
								"type":"play",
								"audio_index":5,
								"delay":false
							}
						]
					}
				]
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT/2+0.07"
			},
			{
				"//":"9: Great job!",
				"type":"play",
				"audio_index":9,
				"delay":true
			},
			{
				"type":"proceed",
				"to_section":"bins"
			}
		]
	},
	{
		"id": "bins",
		"instructions":[
			{
				"//":"0: Now that you've mastered picking up objects with a gripper, let's try placing this box into a bin. It may seem like a simple task, but I can't do it in just one motion. If I try to move the box straight into the bin, I'll collide with the side of the bin, like this.",
				"type":"play",
				"audio_index":0,
				"delay":true
			},
			{
				"type":"adjustPoseBy",
				"geometry":"position",
				"axis":"y",
				"amount":"0.1"
			},
			{
				"type":"goToCartesianPose",
				"position":"None",
				"orientation":"None",
				"relative_pose":"None",
				"joint_angles":"above_fourth_box_joint_arg",
				"endpoint_pose":"None"
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT/2"
			},
			{
				"type":"openGripper"
			},
			{
				"type":"goToCartesianPose",
				"position":"None",
				"orientation":"None",
				"relative_pose":"None",
				"joint_angles":"above_fourth_box_joint_arg",
				"endpoint_pose":"None"
			},
			{
				"//":"1: Can you move the bin back where it was? When it's ready, press the scroll wheel button.",
				"type":"play",
				"audio_index":1,
				"delay":false
			},
			{
				"type":"pressed_button"
			},
			{
				"//":"2: Now let’s try moving this 3rd box into the 2nd bin.",
				"type":"play",
				"audio_index":2,
				"delay": true
			},
			{
				"//":"3: This time, instead of trying to move the box straight into the bin, I'll add a couple of steps in the middle. Help me set up a series of waypoints so that I can put the box into the bin.",
				"type":"play",
				"audio_index":3,
				"delay":true
			},
			{
				"type":"pos_orient"
			},
			{
				"//":"4: First, can you move my hand so its position is over the box and the gripper is in the correct orientation? Use the gray and white buttons on my wrist to switch between position and orientation modes. Press the scroll wheel to continue.",
				"type":"play",
				"audio_index":4,
				"delay":false
			},
			{
				"type":"cuff_interaction",
				"terminatingCondition":"lambda self: self.finished",
				"ways": true
			},
			{
				"//":"5: Next, lower, my hand so that the box is in between the gripper. Make sure the gripper is low enough so that it can get a good grasp of the box. Press the scroll wheel to continue.",
				"type":"play",
				"audio_index":5,
				"delay":false
			},
			{
				"type":"interaction_control",
				"position_only":false,
				"orientation_x":false,
				"orientation_y":false,
				"orientation_z":false,
				"position_x":false,
				"position_y":false,
				"position_z":true,
				"in_end_point_frame":true,
				"PASS":true,
				"ways":true,
				"wait":true
			},
			{
				"type":"closeGripper"
			},
			{
				"//":"6: Now, lift my hand high enough so that the box higher than the bin. Press the scroll wheel to continue.",
				"type":"play",
				"audio_index":6,
				"delay":false
			},
			{
				"type":"interaction_control",
				"position_only":false,
				"orientation_x":false,
				"orientation_y":false,
				"orientation_z":false,
				"position_x":false,
				"position_y":false,
				"position_z":true,
				"in_end_point_frame":true,
				"PASS":true,
				"ways":true,
				"wait":true
			},
			{
				"type":"pos_orient"
			},
			{
				"//":"7: Next, move my hand so it is directly over Bin 1 and the gripper is in the correct orientation. Use the gray and white buttons on my wrist to switch between position and orientation modes. Press the scroll wheel button to continue.",
				"type":"play",
				"audio_index":7,
				"delay":false
			},
			{
				"type":"cuff_interaction",
				"terminatingCondition":"lambda self: self.finished",
				"ways": true
			},
			{
				"//":"8: Finally, lower my hand so that is just above the bin. Make sure the hand is low enough so that when it drops Box 3, it doesn't drop too far, but high enough so that my grippers don't hit the side of the box. Then, press the scroll wheel button to open my gripper.",
				"type":"play",
				"audio_index":8,
				"delay":false
			},
			{
				"type":"interaction_control",
				"position_only":false,
				"orientation_x":false,
				"orientation_y":false,
				"orientation_z":false,
				"position_x":false,
				"position_y":false,
				"position_z":true,
				"in_end_point_frame":true,
				"PASS":true,
				"ways":true,
				"wait":true
			},
			{
				"type":"openGripper"
			},
			{
				"//":"9: Please stand back so I can reset my position to be over Box 4.",
				"type":"play",
				"audio_index":9,
				"delay":true
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT+0.07"
			},
			{
				"type":"goToCartesianPose",
				"position":"None",
				"orientation":"None",
				"relative_pose":"None",
				"joint_angles":"above_fourth_box_joint_arg",
				"endpoint_pose":"None"
			},
			{
				"//":"10: Can you please put Box 3 back into its designated position? Press the scroll wheel button once you've done so.",
				"type":"play",
				"audio_index":10,
				"delay":false
			},
			{
				"type":"pressed_button"
			},
			{
				"//":"11: Now, I'm going to place Box 3 into Bin 1 based on the waypoints you set up for me!",
				"type":"play",
				"audio_index":11,
				"delay":true
			},
			{
				"type":"goToJointAngles",
				"joint_angles":"waypoints.pop(0)"
			},
			{
				"type":"goToJointAngles",
				"joint_angles":"waypoints.pop(0)"
			},
			{
				"type":"closeGripper"
			},
			{
				"type":"goToJointAngles",
				"joint_angles":"waypoints.pop(0)"
			},
			{
				"type":"goToJointAngles",
				"joint_angles":"waypoints.pop(0)"
			},
			{
				"type":"goToJointAngles",
				"joint_angles":"waypoints.pop(0)"
			},
			{
				"type":"openGripper"
			},
			{
				"//":"13: Great job! Please stand back so I can adjust",
				"type":"play",
				"audio_index":13,
				"delay":true
			},
			{
				"type":"adjustPoseTo",
				"geometry":"position",
				"axis":"z",
				"amount":"Module.Z_TABLE+Module.BOX_HEIGHT+0.07"
			},
			{
				"type":"proceed",
				"to_section":"camera"
			}
		]
	},
	{
		"id": "camera",
		"instructions":[
			{
				"type":"goToJointAngles",
				"joint_angles":"camera_pos"
			},
			{
				"//":"0: Now that we are able to put the boxes into the bins, how do I know that I successfully put the box inside the bin?",
				"type":"play",
				"audio_index":0,
				"delay":true
			},
			{
				"//":"1: If you look at my wrist, I have a camera. I can use this camera to determine the location of the box with respect to the location of the bin.",
				"type":"play",
				"audio_index":1,
				"delay":true
			},
			{
				"//":"3: First, I take a picture of the projector screen, which will look something like this...",
				"type":"play",
				"audio_index":2,
				"delay":true
			},
			{
				"type":"camerabw_graphic"
			},
			{
				"//":"4: Then, I detect the Apriltag and the contours of the bin and trace them with different colors.",
				"type":"play",
				"audio_index":3,
				"delay":true
			},
			{
				"type":"camera_color_graphic"
			},
			{
				"//":"5: The green box traces the perimeter of the bin and the blue dot indicates the center of the bin.",
				"type":"play",
				"audio_index":4,
				"delay":true
			},
			{
				"type":"camera"
			},
			{
				"//":"6: Putting this into practice, this is what I see.",
				"type":"play",
				"audio_index":5,
				"delay":true
			},
			{
				"type":"show_camera"
			}
		]
	}
]}